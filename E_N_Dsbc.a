; E_N_D (END OF PROGRAM)
; THIS SR IS THE SUBBROUTINE THAT IS CALLED BY THE USER AT THE END OF ANY PROGRAM WRITING
; REMEMBER TO DECREMENT THE CURRENT ADDRESS MEMORY LOC BEFORE SAVING IT INSIDE END MEMORY LOCATION

; *** REMEMBER THE S1 - S4 AND L1 - L4

E_N_D:
					CLR_LCD
					D_STR									; DISPLAY THE FOLLOWING STRINGS ON LINE ONE (SINCE LCD DDRAM ADDRESS RESETS WHEN CLEARED)
					DB			' Please Wait... ',0

					PUSH		DPH							; SAVE THIER CONTENTS
					PUSH		DPL
					
					MOV			R1, #43H					; STARTING ADDRESS OF THE RESERVED AREA FOR ...
					MOV			R0, #42H					; RESULTS OF THE EXAMINED 8085'S REG. = PAGE ADDRESS

; ------------------------------------
					MOV			DPH, 43H				   	; THE PAGE ADDRESS CONTAINS THE BEGINNING OF THE MEMORY SPACE WHERE THE CONTENT...
					MOV			DPL, 42H				   	; OF EXAMINED 8085'S REGISTERS ARE SAVED. 1 OF (2 BYTE X 7)
															; FOR REGISTER A

					INC			DPTR						; THE ADDRESS OF THE RESERVED AREA FOR THE EXAMINED REGISTERS. 2 OF (2 BYTE X 7)
					MOV			45H, DPH				   	; FOR REGISTER B
					MOV			44H, DPL				   	

					INC			DPTR						; THE ADDRESS OF THE RESERVED AREA FOR THE EXAMINED REGISTERS. 3 OF (2 BYTE X 7)
					MOV			47H, DPH				   	; FOR REGISTER C
					MOV			46H, DPL				   	

					INC			DPTR						; THE ADDRESS OF THE RESERVED AREA FOR THE EXAMINED REGISTERS. 4 OF (2 BYTE X 7)
					MOV			49H, DPH				   	; FOR REGISTER D
					MOV			48H, DPL				   	

					INC			DPTR						; THE ADDRESS OF THE RESERVED AREA FOR THE EXAMINED REGISTERS. 5 OF (2 BYTE X 7)
					MOV			4BH, DPH				   	; FOR REGISTER E
					MOV			4AH, DPL				   	

					INC			DPTR						; THE ADDRESS OF THE RESERVED AREA FOR THE EXAMINED REGISTERS. 6 OF (2 BYTE X 7)
					MOV			4DH, DPH				   	; FOR REGISTER H
					MOV			4CH, DPL				   	

					INC			DPTR						; THE ADDRESS OF THE RESERVED AREA FOR THE EXAMINED REGISTERS. 7 OF (2 BYTE X 7)
					MOV			4FH, DPH				   	; FOR REGISTER L
					MOV			4EH, DPL				   	


; ------------------------------------
;					MOV			A, #7FH						; SAVE THE HEXCODE (8085 INST. SET) OF THE INSTRUCTION 'MOV	A, A' 
					CALL		END_LOADER					; NOTICE THAT IT IS NOT NECESSARY FOR uP TO CARRY OUT THE ABOVE INSTRUCTION

					MOV			A, #78H						; SAVE THE HEXCODE (8085 INST. SET) OF THE INSTRUCTION 'MOV	A, B' 
					CALL		END_LOADER

					MOV			A, #79H						; SAVE THE HEXCODE (8085 INST. SET) OF THE INSTRUCTION 'MOV	A, C' 
					CALL		END_LOADER

					MOV			A, #7AH						; SAVE THE HEXCODE (8085 INST. SET) OF THE INSTRUCTION 'MOV	A, D' 
					CALL		END_LOADER

					MOV			A, #7BH						; SAVE THE HEXCODE (8085 INST. SET) OF THE INSTRUCTION 'MOV	A, E' 
					CALL		END_LOADER

					MOV			A, #7CH						; SAVE THE HEXCODE (8085 INST. SET) OF THE INSTRUCTION 'MOV	A, H' 
					CALL		END_LOADER

					MOV			A, #7DH						; SAVE THE HEXCODE (8085 INST. SET) OF THE INSTRUCTION 'MOV	A, L' 
					CALL		END_LOADER

					POP			DPL							; RETRIEVE THIER CONTENT 
					POP			DPH							; (ELOO CHECK IF THIS AND THE OTHER INSTRUCTION ABOVE IS NECESSARY)
; ELOO YOU MAY INCLUDE AT MOST 1 OR 2 SECONDS DELAY SO THAT THE LCD MESSAGE ABOVE MAY BE VISIBLE TO THE USER
					CLR_LCD
					D_STR									; DISPLAY THE FOLLOWING STRINGS ON LINE ONE (SINCE LCD DDRAM ADDRESS RESETS WHEN CLEARED)
					DB			'      Done!!!     ',0

					JNB			0CH, $						; JUST STAY HERE WHILE THE USER ANALYIZE HE/HER DATA

; ------------------------------------
END_LOADER:			INC			DPTR						; SEND TO THE EXTERNAL DATA MEM. THE HEXCODE (IN 8085uP INSTRUCTION SET) TO READ  
					MOVX		@DPTR, A					; THE CONTENT OF THE REGISTER TO BE EXAMINED AND PLACE IT IN 8085''s ACCUMMULATOR

					MOV			A, #32H						; SAVE THE HEXCODE (8085 INST. SET) OF THE INSTRUCTION 'STA ....'  
					INC			DPTR
					MOVX		@DPTR, A					; PLACE IN THE EXTERNAL DATA MEMORY

					MOV			A, @R0						; LOAD THE SECOND BYTE (LOB OF THE ADDRESS) FIRST AS ASSMBLEY PRINCIPLE DEMANDS
					INC			DPTR
					MOVX		@DPTR, A					; PLACE IN THE EXTERNAL DATA MEMORY

					MOV			A, @R1		 				; LOAD THE THIRD BYTE (HOB OF THE ADDRESS) SECOND AS ASSMBLEY PRINCIPLE DEMANDS					
					INC			DPTR
					MOVX		@DPTR, A					; PLACE IN THE EXTERNAL DATA MEMORY

					INC			R1							; GET READY FOR THE NEXT ADDRESS TRANSFER
					INC			R0

					RET