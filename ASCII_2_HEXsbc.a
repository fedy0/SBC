; THIS SUBROUTINE CONVERTS A GIVEN ASCII CHARACTER INTO ITS EQUIVALENT HEXADECIMAL NUMBER USING 8051 INSTRUCTION SETS
; SOME ADDITIONAL CODE HERE ARE TO ENSURE PROTECTION SINCE THIS SR IS TO BE USED WERE A-Z ALPHABET KEYS ARE AVAILABLE TO BE DEPRESSED

; REGISTER DEFINITION:
; AS AN OPERATING & AN INPUT REGISTER = A

; BI			BIT		04H					; BYTE INDICATOR (INDICATES WHEN AN OPERAND IS A 2 BYTE(4 NIBBLES) OR 1 BYTE (2NIBBLES) )


; ****REMEMBER TO SAVE REGS & FLAGS STILL RELEVANT TO THE CALLER PROGRAM TO AVOID DATA LOSS****

ASCII_2_HEX:	
				CJNE	A, #30H, A2H_1	; THE CONTENT OF 'A' MUST SATISFY THE FOLLOWING INEQUALITY: 30H =< A =< 46H
				CLR		C				; ENSURE IT PASSES TO THE NEXT INSTRUCTION

A2H_1:			JC		EXIT_A2H
				SUBB	A, #30H 		; SUBTRACT 30H FROM A REGISTER
				CJNE	A, #0AH, A2H_2
				CLR		C 				; ENSURE IT PASSES TO THE NEXT INSTRUCTION

A2H_2:			JC		A2H_4
				SUBB	A, #07H			; SUBTRACT 07H FROM 'A' REGISTER
				CJNE	A, #0FH, A2H_3	; CHECK IF THE RESULT OF THE SUBTRACTION IS GREATER THAN 0FH; IF SO EXIT THE SR ELSE CONTINUE
				SETB	C				; ENSURE IT PASSES TO THE NEXT INSTRUCTION

A2H_3:			JNC		EXIT_A2H		
; ELOO U MAY PUT UR FLAG FOR SUB MEM ASCII_2_HEX SR CALL HERE(NOTE SUCH FLAG MUST BE CLEAR AT THE SUB MEM SR ON RETURN IMMEDIATELY)
; EXPECTED FLAG INSTRUCTION: JB		SubMem'sAscii2hexFlag, EXIT_A2H

; THE TEST IS COMPLETED. THE INEQUQLITY: 30H =< A =< 46H HAS BEEN SATISFIED AND CONVERSION HAS TAKEN PLACE!!!

A2H_4:			SETB	02H				; THE FLAG, 02H BEEN SET INDICATES THAT THE KEY PRESSED IS BETWEEN 0 - F IN HEX
				CLR		C				; ENSURE THAT THE SUBTRCTION IS DONE WITHOUT BORROW(ie THE CARRY FLAG)

; MARRIAGE BEGINS
				JNB		04H, A2H_7		; MEM BIT, 04H = 1 MEANS 2 BYTES(4 NIBBLES) & 04H = 0 MEANS 1 BYTE (2 NIBBLES)
				JB		06H, A2H_5		; HAS THE MARRIAGE OF HIGH ORDER BYTE COMPLETED? FOR NO, 06H = 1; FOR YES, 06H = 0
				SJMP	A2H_7			; JMUP FOR THE LOWER BYTE OF ADDRESS

; FOR HIGHER ORDER BYTE OF AN ADDRESS
A2H_5:			CPL		05H				; CONTROLS THE NIBBLE MARRIAGE INTO A BYTE
				JB		05H, A2H_6
				ORL		A, 35H			; MARRY MSB(1ST NIBBLE IN MEM LOC. 34H) AND THE LSB(2ND NIBBLE IN 'A') INTO A BYTE DATA OR ADDRESS
				MOV		35H, A			; SAVE THE FINAL RESULT IN MEM LOC. 35H 
				CLR		06H				; CLEARS ON MARRIAGE COMPLETION FOR HIGH ORDER BYTE
				SJMP	EXIT_A2H

A2H_6:			RL		A				; SWAP MSB AND LSB
				RL		A
				RL		A
				RL		A
				MOV		35H, A			; SAVE THE CURRENT RESULT IN MEM LOC. 35H

				SJMP 	EXIT_A2H

; FOR DATA OR LOWER ORDER BYTE OF AN ADDRESS
A2H_7:			CPL		05H				; CONTROLS THE NIBBLE MARRIAGE INTO A BYTE
				JB		05H, A2H_8
				ORL		A, 34H			; MARRY MSB(1ST NIBBLE IN MEM LOC. 34H) AND THE LSB(2ND NIBBLE IN 'A') INTO A BYTE DATA OR ADDRESS
				MOV		34H, A			; SAVE THE FINAL RESULT IN MEM LOC. 34H 
				SJMP	EXIT_A2H

A2H_8:			RL		A				; SWAP MSB AND LSB
				RL		A
				RL		A
				RL		A
				MOV		34H, A			; SAVE THE CURRENT RESULT IN MEM LOC. 34H

EXIT_A2H:
				RET						; RETURN TO THE CALLER PROGRAM

; TESTED: QC PASSED SYNTAXICALLY